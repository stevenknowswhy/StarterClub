(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,2410,e=>{"use strict";var t=e.i(32414),r=e.i(38703),s=e.i(71645);function a(){let{getToken:e}=(0,r.useAuth)();return(0,s.useMemo)(()=>(0,t.createClient)("https://exancwcrkqivoaqhmapr.supabase.co","sb_publishable_clKIKp_at0Sq9VWrIlOX1Q_wwVpnV1l",{global:{fetch:async(t,r={})=>{let s=await e({template:"supabase"}),a=new Headers(r?.headers);return s&&a.set("Authorization",`Bearer ${s}`),fetch(t,{...r,headers:a})}}}),[e])}e.s(["useSupabase",()=>a])},47073,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(2410),a=e.i(27085);function i(){let e=(0,s.useSupabase)(),{user:i}=(0,a.useUser)(),[n,o]=(0,r.useState)([]),l=e=>o(t=>[...t,`${new Date().toISOString().split("T")[1]} ${e}`]),u=async()=>{l("Checking current_jwt()...");let{data:t,error:r}=await e.rpc("current_jwt");r?l(`Error: ${r.message}`):l(`Success! JWT Claims: ${JSON.stringify(t,null,2)}`)},c=async()=>{if(l("Starting Write Test..."),!i)return void l("No user logged in (Clerk). Aborting.");l("Attempting to read 'partner' resources...");let{data:t,error:r}=await e.from("resource_assets").select("*").eq("visibility","partner").limit(1);r?l(`Read Resources Error: ${r.message}`):l(`Read Resources Success: Found ${t.length} items.`),l("Checking if user exists in DB...");let{data:s,error:a}=await e.from("partner_users").select("*").eq("clerk_user_id",i.id).single();if(a||!s){l("User not found in partner_users. Cannot test org-scoped writes."),l("Suggestion: Insert a row manually in Supabase dashboard for this user.");return}l(`User found: ${s.id} (Org: ${s.org_id})`);let{data:n,error:o}=await e.from("calculator_runs").insert({org_id:s.org_id,track:"banks",inputs:{test:!0},outputs:{result:"ok"}}).select();o?l(`Write Calculator Run Error: ${o.message}`):l(`Write Calculator Run Success: ID ${n[0].id}`)},d=async()=>{l("Testing RLS (Reading other org data)...");let{data:t,error:r}=await e.from("calculator_runs").select("*").limit(5);r?l(`Read Error (unexpected?): ${r.message}`):(l(`Read Success. Rows: ${t.length}`),l("Manually verify that these belong to your org."))};return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)("button",{onClick:u,className:"px-4 py-2 bg-blue-600 text-white rounded",children:"1. Check Token (RPC)"}),(0,t.jsx)("button",{onClick:c,className:"px-4 py-2 bg-green-600 text-white rounded",children:"2. Write Test"}),(0,t.jsx)("button",{onClick:d,className:"px-4 py-2 bg-red-600 text-white rounded",children:"3. RLS Check"})]}),(0,t.jsx)("div",{className:"bg-gray-900 text-green-400 p-4 rounded font-mono text-sm min-h-[200px] overflow-auto",children:0===n.length?"Logs will appear here...":n.map((e,r)=>(0,t.jsx)("div",{children:e},r))})]})}e.s(["default",()=>i])}]);